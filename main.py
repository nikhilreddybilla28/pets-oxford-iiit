# -*- coding: utf-8 -*-
"""main.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1vA08moCFHhIT7wbnfpd05lrbJwuqKQSP
"""

#!pip install streamlit

from fastai.vision import *
from fastai import *

import pickle
import joblib
import os
import streamlit as st

cwd = os.getcwd()
path = Path()

classifier = load_learner(path, 'models/res34.pkl')

def predict(img):
  pred=classifier.predict(img)
  print(pred[0])
  return pred[0]

def main():
    st.title("Pet Breed Classifier")
    html_temp = """
    <div style="background-color:tomato;padding:12px">
    <h2 style="color:white;text-align:center;"> Bredd classifier App </h2>
    </div>
    """
    st.markdown(html_temp,unsafe_allow_html=True)
    img = st.file_uploader("Choose an image...", type="jpg")
    if img is not None:
      st.image(img, caption='Uploaded Image.', use_column_width=True)
      st.write("")
      st.write("Classifying...")
      result=" "
      if st.button("Predict"):
        result=predict(img)
      st.success('The above image is {}'.format(result))

if __name__=='__main__':
    main()
